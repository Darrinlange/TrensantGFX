<html>
<head>
<!-- HTML header code for trensant-gfx demo. M A Chatterjee 20170525 -->
<link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>     <!-- jquery is used for DOM stuff  -->

<!-- bootstrap is used for div management -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>  <!-- not part of graphics library just here for div and layour mgmt -->

<!--css for d3 rendering -->
<link rel="stylesheet" href="./style/trensantGFX.css">

<script type="text/javascript" src="./libs/helper-fns.js"></script>  <!-- helper-fns is a library for doing generec web work like URL param managment -->


<!-- core graphics library includes.  -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>  <!-- google charts loader -->
<script type="text/javascript" src="https://www.google.com/jsapi"></script>              <!-- as of 20170620 Google says it needs this for maps -->

<script src="https://d3js.org/d3.v4.min.js"></script>  				 <!-- not compatible with d3.v3 or earlier  -->
<script type="text/javascript" src="./libs/wordcloud2.js"></script>  <!-- wordcloud2.js is a wordcloud library -->


<!-- see more about jqcloud here: https://github.com/mistic100/jQCloud -->
<script type="text/javascript" src="./libs/jqcloud.min.js"></script> <!-- jQCloud is a word cloud library -->
<link rel="stylesheet" href="./libs/jqcloud.min.css"> 				 <!-- jQCloud requires this css file  -->


<!--  maps -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBwB-0FhqcR0eYbf4utsUNN02i8olM6ork" ></script>  <!-- google maps -->


<!-- trensantGFX wrapper!  -->
<script type="text/javascript" src="./trensantGFX.js"></script>      <!-- TrensantGFX is the main lib for all wrappers!                               -->


<title>Trensant Graphics Wrapper Library</title>
<style type="text/css">

.cssChart {
	height: 500px;
}
</style>
</head>
<body>
<!-- index.html ... trensantGFX tester 

M A Chatterjee 2017-06-05 :: note requires trensant-text-header.html 
URL params
drawBanner=false    				// supress or show the top Trensant Logo
-->

<div class='container' >     <!-- boostrap container               -->
	<div class='col-md-12'>  <!-- boostrap basic column management -->
	<div class="row">
		<div class='top-banner' id="topBanner">	</div> <!-- top banner is dynamically drawn -->
		<h1>Trensant Graphics</h1>
		<p>This is the Trensant Graphics Library Demo page.  The Trensant Graphics Library is a wrapper of several 3rd party graphics and charting libraries which are useful for visualizing data using different techniques.  See the README.md file in the distribution for more on which libraries and charts are wrapped and how to use them.
		<br>
		<div id='test'></div>  <!-- spare test div, to be deleted -->
		<h2>Charts</h2>
		<div id='tocDIV'></div>  <!-- table of contents goes here, dynamically populated -->
		<br>
		<div id="graphicsDiv"></div> <!-- chart sections go here, dynmaically populated -->
	</div>
	</div>
</div>

<!-- Begin code ************************************************************************************************ -->
<script>
	//global vars
	google.charts.load('current', {'packages':['table','corechart','geochart','line']});
	google.charts.setOnLoadCallback(function(){gAvail["table"]=true; gAvail["pie"]=true; gAvail["geochart"]=true; });
	// end static inits ......
	var gCharts = {"toc":[]};
	var gDrawBanner = true; 
	if ((hf.getURLParam("drawBanner") != "false") && (gDrawBanner==true))
		document.getElementById("topBanner").innerHTML= "<a href='http://trensant.com'><img src='./img/Trensant_apricot_flat_sm.png'></img></a><br><br>";
	var gAvail ={};
	var div;

	//============================================================================
	/*
	drawNewSectionDiv()

	dynmacally generate all the dom elements for a section for this page in this form:

	<div id=domID>
		<h3  id='domID_heading' 	>Chart Name</h3>  			// name of this chart           
		<p   id='domID_desc'   		>description</p>  			// description string of this chart.  can be HTML 
		<br>
		<h4  id='domID_dataHeading' >Chart Data Heading</h4>  	// data heading
		<pre id='domID_data'        >data area </pre>			// raw data shown here 
		<br>
		<h4  id='domID_chartHeading'>Chart Example Hading</h4>  // title above chart area
		<div id='domID_chart' 		>chart renders here</div>   // rendering area this chart
	</div>

	it also adds to the table of contents at the top and generates in-page links e.g. #mySpecialChart

	required fields:
		domID 		 // DOM for base div.  all interall components will be give sub ids based on this.  
		opts["name"] // used for internal ref
		
	
	*/
	function drawNewSectionDiv (domID,opts) { 
		if (typeof domID == "undefined") {
			console.log ("must have id"); return null;
		}
		var i,x,dopts = {
			"name"   : "Chart Name",
			"line_break" : true,
			"chartCss"   : '' +
            '', // this is the default cssClass for the chart div.  Can overide with a string "myChartClass1 myChartClass2" etc
			"chartSty"   : ''          // allows styles to be passed to the chart div  eg "width:500; color:red" etc
		};
		if (trensantGFX.typeOf(opts) == "object")
			for (i in opts) 
				dopts[i] = opts[i]; 

		// individual sections.  these can be overriden by passing in a block like this as opts["sections"]= [ [] [] []]
		dopts["sections"] = [
			 //tag  , id_suffix ,  default content, css_class
			 ["h2"	,'_heading'		,  dopts["name"]				               ],
			 ["p" 	,'_desc'   		,  'Overview text goes here'	               ],
			 ["br"  ,'_break1'      , ''                                           ],
			 ["h4"	,'_dataHeading' ,  'Example Data (click to show/hide)'		   ],
			 ["pre"	,'_data' 		,  'Formatted data example area for this chart'],
			 ["br"  ,'_break2'      , ''                             	           ],
			 ["h4"	,'_chartHeading',  'Example Rendering'				 		   ],			 
			 ["div" ,'_chart' 		,  'rendered chart goes here'    , dopts["chartCss"], dopts["chartSty"]  ]
			];

		if (trensantGFX.typeOf(opts) == "object")
			for (i in opts) 
				dopts[i] = opts[i];   // this loop is repeated to pick up overrides such as dopts["name"], dopts["chartCss"]
		

		var node = document.createElement("div");
		node["id"] = domID; // the id for container div

		for (i=0; i < dopts["sections"].length; i++) {
			x = document.createElement(dopts["sections"][i][0]);
			x["id"] = domID+dopts["sections"][i][1];
			x["innerHTML"] = dopts["sections"][i][2];
			x["className"] = typeof dopts["sections"][i][3] == "undefined" ? "" : dopts["sections"][i][3] ;  
			x["style"]     = typeof dopts["sections"][i][4] == "undefined" ? "" : dopts["sections"][i][4] ;
			node.appendChild(x);
		}
		if (dopts["line_break"] == true) {
			x = document.createElement('hr');
			node.appendChild(x);
		}
		document.getElementById("graphicsDiv").appendChild(node); // add this section to the document
		$('#'+domID+"_dataHeading").click(function(){ $('#'+domID+"_data").toggle(200);});
		$('#'+domID+"_data").hide(); // default is hidden

		//update table of contents
		addTOCEntry(dopts["name"],domID);
		updatePageTOC(); //redraw TOC

		return document.getElementById(domID); // return node ref
	}
	
	//===================================================================================================
	// update the Table of Contents.
	// TOC links are drawn with HTML in page links so that we can easily bookmark them
	function updatePageTOC() {
		var i,h="";
		for (i in gCharts["toc"]) {
			h+= "<a href='#"+gCharts["toc"][i]["base_id"]+"'' >"+gCharts["toc"][i]["name"]+"</a><br>";
		}
		document.getElementById("tocDIV").innerHTML = h;
	}

	function addTOCEntry(name,domID) {
		gCharts["toc"].push( {"name" : name, "base_id" : domID});
	}
	//===================================================================================================
	// now begins the chart gallery
	
	function mainArea() {
	//===================================================================================================
	//===================================================================================================
	// trensantGFX.tgPrettyPrint
	drawNewSectionDiv('tgPrettyPrintDiv',{"name":"tgPrettyPrint"});
	var prettyPrintSampleData = {
		"sample-array" : [1,2,3,4,5,"another piece"],
		"key" : "value",
		"sample-dict" : {1:2, 3:4, 5:6},
		"num" : 2343.32
	};

	//emit description info
	$("#tgPrettyPrintDiv_desc").html("tgPrettyPrint is a function for taking any JSON object and pretty printing to an HTML container div.<br><pre>//Example<br>var x= ... my data of any valid javascript type ...;<br>trensantGFX.tgPrettyPrint(myData,myDiv);<br></pre>");

	//show the raw data
	trensantGFX.tgPrettyPrint(prettyPrintSampleData,"tgPrettyPrintDiv_data");

	//render the chart
	trensantGFX.tgPrettyPrint(prettyPrintSampleData,"tgPrettyPrintDiv_chart");
	//$("#tgPrettyPrintDiv_chart").html(""); // in this case the chart and the data are the same so we don't render a chart

	//===================================================================================================
	//===================================================================================================
	// trensantGFX.rowWordCloud
	div = "tgRowWordCloudDiv";
	drawNewSectionDiv(div,{"name":"tgRowWordCloud"});
	

	//emit description info
	$("#"+div+"_desc").html("tgRowWordCloud takes an array of word frequencies of the form [[word, freq, optional_color],[word2, freq2, optional_color], [word3,freq3],.. ] and renders a word cloud as a series of rows in a div. <br>Options include minSize, maxSize, and sort.  Sorting can be alpha, ralpha (reverse alpha), and numeric.  See docs.  <br><pre>var x = [['word1', 12], ['word2', 52], ['word3', 45]];<br>trensantGFX.drawRowWordCloud(x,myDiv);<br></pre>");

	var rowWordCloudSampleData = [   // note colors are optional, and can be HTML colors e.g. "#f44", data does not need to be sorted
		["deal", 1998, "red"],
  		["shoe", 1925, "red"],
  		["nfl",  1895, "orange" ],
  		["nike", 1698,   "red"  ], 
  		["lucrative", 1673, "green" ],
  		["@nfl",    1649,   "red"  ],
  		["obj",    1469,    "orange"],
  		["5-year",  1405,    "purple" ],  
  		["25m",    1402,    "orange"],
  		["safety",  690,    "purple"],
  		["player",   566,    "purple"],
  		["@browns",  545,   "green" ],
  		["league",    531,    "purple" ],
  		[ "much",    525,    "red"  ],  
  		[ "speed",    490,    "green"],
  		[ "receiving",  486,   "green"],
		["fastest",  4484,    "orange"],
  		[  "game",   458,    "red"  ],
  		[ "midseason",   456,  "green"]
  		];	
  	var rowWordOpts = {"minSize":10,"maxSize":30,"sort":"alpha"};

	//show the raw data
	trensantGFX.tgPrettyPrint(rowWordCloudSampleData,div+"_data");

	//render the chart
	trensantGFX.tgDrawRowWordCloud( rowWordCloudSampleData,div+"_chart",rowWordOpts);
	
	//===================================================================================================
	//===================================================================================================		
	// trensantGFX.gglDrawPieChart() 
	div = "gglDrawPieChartDiv";
	drawNewSectionDiv(div,{"name":"gglDrawPieChart"});	

	//emit description info
	$("#"+div+"_desc").html("gglDrawPieChart takes an array of data of the form [[term, value],[term2, value2], [term3,value3],.. ] and renders a pie Chart using Google charts.");

	var pieChartData = [   // note colors are optional, and can be HTML colors e.g. "#f44", data does not need to be sorted
		["Category", "Percent"],  //note pie chart will convert raw values to percents
		["deal", 	198  ],
  		["shoe", 	1925 ],
  		["nfl",  	495  ],
  		["nike", 	243  ], 
  		["speed",    490 ],
  		[ "game",   2458 ]
  		];	
  	var pieChartOpts = {};

	//show the raw data
	trensantGFX.tgPrettyPrint(pieChartData,div+"_data");

	//render the chart
	trensantGFX.gglDrawPieChart(pieChartData,div+"_chart",pieChartOpts);
	
	//===================================================================================================
	//===================================================================================================		
	// trensantGFX.gglDrawPieChart() 
	div = "gglDrawLineChartDiv";
	drawNewSectionDiv(div,{"name":"gglDrawLineChart"});	

	//emit description info
	$("#"+div+"_desc").html("gglDrawLineChart takes an array of data of the form  and renders a line Chart using Google charts.");

	var lineChartData =
		[ 
		['x-axis','series0','series2','series3'],
   		[ 0,23,34,45],
   		[ 10,34,45,63],
   		[ 20,16,38,99],
   		[ 30,31,36,32]
   		];
  	var lineChartOpts = {};

	//show the raw data
	trensantGFX.tgPrettyPrint(lineChartData,div+"_data");

	//render the chart
	trensantGFX.gglDrawLineChart(lineChartData,div+"_chart",lineChartOpts);
	
	//===================================================================================================		
	// trensantGFX.gglDrawPieChart() 
	div = "gglDrawBarChartDiv";
	drawNewSectionDiv(div,{"name":"gglDrawBarChart"});	

	//emit description info
	$("#"+div+"_desc").html("gglDrawBarChart takes an array of data of the form  and renders a bar Chart using Google charts.");

	var barChartData =
		[ 
		['x-axis','series0','series2','series3'],
   		[ 0,23,34,45],
   		[ 10,34,45,63],
   		[ 20,16,38,99],
   		[ 30,31,36,32]
   		];
  	var barChartOpts = {};

	//show the raw data
	trensantGFX.tgPrettyPrint(barChartData,div+"_data");

	//render the chart
	trensantGFX.gglDrawBarChart(barChartData,div+"_chart",barChartOpts);
	
	
	//===================================================================================================		
	//===================================================================================================		
	//trensant.d3treeMap
    div = "d3TreeMapDiv";
    drawNewSectionDiv(div,{"name":"d3TreeMapDiv"});

    //emit description info
    $("#"+div+"_desc").html("treemap draws a treemap");

    var treeMapSampleData =  { node: {
      child_name: "Anheuser-Busch",
      child_id: "565ec0939b72473c7ec9e1ad",
      children:
        [
          {
            parent_name: "Anheuser-Busch",
            child_tags: [],
            child_name: "Budweiser Beer",
            parent_id: "565ec0939b72473c7ec9e1ad",
            child_buzz: 79,
            child_id: "53166c755f3b284a609e1c6b",
            children: [
              {
                parent_id: "53166c755f3b284a609e1c6b",
                child_buzz: 6342,
                child_id: "58781b703805ab195625df2c",
                child_name: "@budweiser",
                parent_type: "product",
                children: [
                  {
                    parent_id: "58781b703805ab195625df2c",
                    child_buzz: 3483,
                    child_id: "565ea6efefa9d5d882d273",
                    child_name: "childBudweiser",
                  }
                ]
              },
              {
                parent_id: "53166c755f3b284a609e1c6b",
                child_buzz: 3483,
                child_id: "565ea6efefa9dd25d882d273",
                child_name: "Budweiser"
              },
              {
                parent_id: "53166c755f3b284a609e1c6b",
                child_buzz: 250,
                child_id: "58781a533805ab195625df2a",
                child_name: "#budweiser"
              },
              {
                parent_id: "531c755f3b284a609e1c6b",
                child_buzz: 1250,
                child_id: "58781a533805ab195625df2a",
                child_name: "#my_best_budweiser",
              }
            ]
          },
          {
            child_name: "Bud Light Beer",
            child_type: "product",
            parent_id: "565ec0939b72473c7ec9e1ad",
            child_id: "53166f5c5f3b284a609e1c72",
            children: [
              {
                parent_id: "53166c75284a609e1c6b",
                child_buzz: 4342,
                child_id: "58781b703805ab195625df2c",
                child_name: "@budweiser",
              }]

          }
        ]
    } }

    //display sample data
	trensantGFX.tgPrettyPrint(treeMapSampleData, div+"_data")

	//render the chart
    trensantGFX.d3TreeMap(treeMapSampleData, div+"_chart", {parentID: "parent_id", childID: "child_id",
      childName: "child_name", value: "child_buzz", svgWidth: $('#'+div).width()});

	//===================================================================================================
	//trensant.d3radialTree
	div = "d3RadialTree";
    drawNewSectionDiv(div,{"name":"d3RadialTree"});

	var radialTreeSampleData = {name: "Current Article", children: [{name: "Dow Jones Index", children: [{name: "Apple", children: [{name: "MacBook"}, {name: "IPhone"}]},{name: "Home Depot"}, {name: "Amgen"}, {name: "IBM"}, {name: "Average"}]}, {name: "Wall Street", children: [{name: "American Express", children: [{name: "Credit Card"}, {name: "Debt"}, {name: "Freedom"}, {name: "Money"}, {name: "Payments"}, {name: "Freshman"}]},{name: "Bernie Madoff"}, {name: "Greed"}]}]}

	//emit description info
    $("#"+div+"_desc").html("radiale tree draws a radialtree");

    //display sample data
    trensantGFX.tgPrettyPrint(radialTreeSampleData, div+"_data")

    //render the chart
      trensantGFX.d3RadialTree(radialTreeSampleData, div+"_chart", {textClick: "mouseover", onClick: function () {d3.select(this).style("fill", "red")}, svgWidth: $('#'+div).width()});

//  ===================================================================================================
	  div = "d3Chord";
	  drawNewSectionDiv(div,{"name":"d3Chord"});
	  var chordSampleData = {matrix : [
        [0, 0, 1000, 1000],
        [0, 0, 1000, 1000],
        [1000, 1000, 0, 1000],
        [1000, 1000, 1000, 0]
      ], groups: ["A", "B", "C", "D"]}

      //emit description info
      $("#"+div+"_desc").html("Chord Chart");

      //display sample data
      trensantGFX.tgPrettyPrint(chordSampleData, div+"_data");

      //render the chart
      trensantGFX.d3Chord(chordSampleData, div+"_chart", {svgWidth: $('#'+div).width()});

// ===================================================================================================
	  div = "d3ZoomableSunburst";
      drawNewSectionDiv(div,{"name":"d3ZoomableSunburst"});
      var sunburstSampleData = {name: "flare",
        children: [
          {
            name: "analytics",
            children: [
              {
                name: "cluster",
                children: [
                  {name: "AgglomerativeCluster", size: 3938},
                  {name: "CommunityStructure", size: 3812},
                  {name: "HierarchicalCluster", size: 6714},
                  {name: "MergeEdge", size: 743}
                ]
              },
              {
                name: "graph",
                children: [
                  {name: "BetweennessCentrality", size: 3534},
                  {name: "LinkDistance", size: 5731},
                  {name: "MaxFlowMinCut", size: 7840},
                  {name: "ShortestPaths", size: 5914},
                  {name: "SpanningTree", size: 3416}
                ]
              },
              {
                name: "optimization",
                children: [
                  {name: "AspectRatioBanker", size: 7074}
                ]
              }
            ]
          }
          ]
      }

      //emit description info
      $("#"+div+"_desc").html("Zoomable Sunburst");

      //display sample data
      trensantGFX.tgPrettyPrint(sunburstSampleData, div+"_data");

      //render the chart
      trensantGFX.d3ZoomableSunburst(sunburstSampleData, div+"_chart", {});


	// end main area-----------------------------------------------------------------------------------
	}// mainArea body

	trensantGFX.repeatUntil (trensantGFX.gglChartsLoaded , mainArea,null, 75, 35, function(r,c){if (r==false) console.log('chart load error')}); // this waits for gglcharts to load by checking every 75ms up to 35 times...
	
</script>
	
</body>
</html>
